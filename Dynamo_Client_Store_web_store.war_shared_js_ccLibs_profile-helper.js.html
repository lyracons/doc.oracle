<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Dynamo/Client/Store/web/store.war/shared/js/ccLibs/profile-helper.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: Dynamo/Client/Store/web/store.war/shared/js/ccLibs/profile-helper.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/*global $ */
/**
 * 
 */

define('profileHelper',
['knockout', 'ccRestClient', 'ccConstants'],

function(ko, ccRestClient, ccConstants) {
  "use strict";

  /**
   * Creates a ProfileHelper
   */
  function ProfileHelper() {
    var self = this;
    this.profileData = ko.observable(null);
    this.allowedActions = ko.observableArray(null);
    /**
     * We are having more than one page user one tab. So we are maintaining this
     * map in JS. We can find more optimal way in future
     */
    this.pageAccesskeys = {
            home : [ccConstants.DASHBOARD_TAB , ccConstants.DASHBOARD_MINI_TAB],
            catalog: [ccConstants.CATALOG_TAB],
            'price-groups': [ccConstants.CATALOG_TAB],
            'price-group': [ccConstants.CATALOG_TAB],
            marketing: [ccConstants.MARKETING_TAB],
            reporting: [ccConstants.REPORTS_TAB],
            search: [ccConstants.SEARCH_TAB],
            design: [ccConstants.DESIGN_TAB],
            code: [ccConstants.DESIGN_TAB],
            publish: [ccConstants.PUBLISHING_TAB],
            settings: [ccConstants.SETTINGS_TAB, ccConstants.SETTINGS_LIMITED_TAB],
            accounts: [ccConstants.ACCOUNTS_TAB],
            contacts: [ccConstants.ACCOUNTS_TAB],
            inventory: [ccConstants.CATALOG_TAB],
            css: [ccConstants.DESIGN_TAB],
            theme: [ccConstants.DESIGN_TAB],
            layout: [ccConstants.DESIGN_TAB],
            media: [ccConstants.MEDIA_TAB]
          };
    
    this.restrictedSubTabAccess = {
        emailSettings: [ccConstants.SETTINGS_TAB],
        webAPI: [ccConstants.SETTINGS_TAB],
        accessControl: [ccConstants.SETTINGS_TAB],
        extensions: [ccConstants.SETTINGS_TAB],
        'abandoned-cart': [ccConstants.SETTINGS_TAB],
        'storeEndpointSettings': [ccConstants.SETTINGS_TAB]
    };
    
    this.tourNavigationData = {
          home : {
            url : ccConstants.HOME_PAGE
          },
          catalog : {
            url : ccConstants.AGENT_CATALOG_PAGE_CONTEXT
          },
          marketing : {
            url : ccConstants.MARKETING_PAGE
          },
          reporting : {
            url : ccConstants.REPORTING_PAGE
          },
          search : {
            url : ccConstants.SEARCH_PAGE
          },
          design : {
            url : ccConstants.DESIGN_PAGE
          },
          code : {
            url : ccConstants.CODE_PAGE
          },
          publish : {
            url : ccConstants.PUBLISH_PAGE
          },
          settings : {
            url : ccConstants.SETTINGS_SHIPPINGMETHODS_PAGE,
            lastStop : false
          }
    };
    return (this);
  }
  
  /**
   * This will return true if user is allowed to do this particular action represented by &lt;i>key&lt;/i>
   * @param key action identifier
   */
  ProfileHelper.prototype.isAuthorized = function (keys) {
    var self = this;
    if(keys){
      var currentActions = [];
      if($.isArray(keys)){
        currentActions = keys;
      }else{
        currentActions.push(keys);
      }
      if(self.allowedActions &amp;&amp; self.allowedActions().length > 0 &amp;&amp;
          ($(self.allowedActions()).filter(currentActions).length > 0)){
        return true;
      }
    }
    return false;
  };
  
  /**
   * This will return true if user is allowed to page represented by &lt;i>pageId&lt;/i>
   * @param pageId action identifier
   */
  ProfileHelper.prototype.isAuthorizedForPage = function (pageId) {
    var self = this;
    var keys = self.pageAccesskeys[pageId];
    if(typeof keys === "undefined" || keys === null){
      return undefined;
    }
    return self.isAuthorized(keys);
  };
  
  /**
   * This will return true if user is allowed to tab represented by &lt;i>tabId&lt;/i>
   * @param tabId tab identifier
   */
  ProfileHelper.prototype.isAuthorizedForSubTab = function (tabId) {
    if(!tabId){
      return true;
    }
    var self = this;
    var keys = self.restrictedSubTabAccess[tabId];
    if(typeof keys === "undefined" || keys === null){
      return true;
    }
    return self.isAuthorized(keys);
  };
  
  /**
   * This will return true if user is allowed to page represented by &lt;i>pageId&lt;/i>
   * @param pageId action identifier
   */
  ProfileHelper.prototype.nextAuthorizedPage = function (pageId) {
    if(pageId){
      var self = this;
      var urlParts = pageId.split("/");
      if(urlParts){
        pageId = (urlParts[0] &amp;&amp; urlParts[0].length > 0) ? urlParts[0] : urlParts[1];
      }
      if(typeof pageId === "undefined" || pageId === null){
        return undefined;
      }
      var keyFound = false;
      for (var property in self.pageAccesskeys) {
        if (self.pageAccesskeys.hasOwnProperty(property)) {
          if(property === pageId){
            keyFound = true;
          }
          if(keyFound){
            var keys = self.pageAccesskeys[property];
            if(self.isAuthorized(keys)){
              return self.tourNavigationData[property];
            }
          }
        }
      }
      return null;
    }
  };

  return new ProfileHelper();
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-ccKoErrorWrapper.html">ccKoErrorWrapper</a></li><li><a href="module-ccKoExtensions.html">ccKoExtensions</a></li></ul><h3>Classes</h3><ul><li><a href="Address.html">Address</a></li><li><a href="CartViewModel.html">CartViewModel</a></li><li><a href="DynamicProperty.html">DynamicProperty</a></li><li><a href="EventDispatcher.html">EventDispatcher</a></li><li><a href="GiftCardViewModel.html">GiftCardViewModel</a></li><li><a href="GiftProductListingViewModel.html">GiftProductListingViewModel</a></li><li><a href="ko.bindingHandlers.background.html">background</a></li><li><a href="ko.bindingHandlers.carouselSwipe.html">carouselSwipe</a></li><li><a href="ko.bindingHandlers.ccForm.html">ccForm</a></li><li><a href="ko.bindingHandlers.ccLink.html">ccLink</a></li><li><a href="ko.bindingHandlers.ccValidation.html">ccValidation</a></li><li><a href="ko.bindingHandlers.checkbox.html">checkbox</a></li><li><a href="ko.bindingHandlers.chosen.html">chosen</a></li><li><a href="ko.bindingHandlers.contextResourcesNamespace.html">contextResourcesNamespace</a></li><li><a href="ko.bindingHandlers.currency.html">currency</a></li><li><a href="ko.bindingHandlers.datepicker.html">datepicker</a></li><li><a href="ko.bindingHandlers.datepopover.html">datepopover</a></li><li><a href="ko.bindingHandlers.draggable.html">draggable</a></li><li><a href="ko.bindingHandlers.droppable.html">droppable</a></li><li><a href="ko.bindingHandlers.fade.html">fade</a></li><li><a href="ko.bindingHandlers.hover.html">hover</a></li><li><a href="ko.bindingHandlers.imageSource.html">imageSource</a></li><li><a href="ko.bindingHandlers.imageZoom.html">imageZoom</a></li><li><a href="ko.bindingHandlers.localeText.html">localeText</a></li><li><a href="ko.bindingHandlers.makeAccess.html">makeAccess</a></li><li><a href="ko.bindingHandlers.modal.html">modal</a></li><li><a href="ko.bindingHandlers.modalTabbingContraint.html">modalTabbingContraint</a></li><li><a href="ko.bindingHandlers.onRender.html">onRender</a></li><li><a href="ko.bindingHandlers.popeditor.html">popeditor</a></li><li><a href="ko.bindingHandlers.popover.html">popover</a></li><li><a href="ko.bindingHandlers.productImageSource.html">productImageSource</a></li><li><a href="ko.bindingHandlers.propertyEditor.html">propertyEditor</a></li><li><a href="ko.bindingHandlers.radio.html">radio</a></li><li><a href="ko.bindingHandlers.richTextEditor.html">richTextEditor</a></li><li><a href="ko.bindingHandlers.scrollAffix.html">scrollAffix</a></li><li><a href="ko.bindingHandlers.select2.html">select2</a></li><li><a href="ko.bindingHandlers.select2Tags.html">select2Tags</a></li><li><a href="ko.bindingHandlers.selectable.html">selectable</a></li><li><a href="ko.bindingHandlers.slickList.html">slickList</a></li><li><a href="ko.bindingHandlers.slide.html">slide</a></li><li><a href="ko.bindingHandlers.slider.html">slider</a></li><li><a href="ko.bindingHandlers.spectrum.html">spectrum</a></li><li><a href="ko.bindingHandlers.tagsInput.html">tagsInput</a></li><li><a href="ko.bindingHandlers.textCheck.html">textCheck</a></li><li><a href="ko.bindingHandlers.timepicker.html">timepicker</a></li><li><a href="ko.bindingHandlers.triggerMessage.html">triggerMessage</a></li><li><a href="ko.bindingHandlers.validatableTarget.html">validatableTarget</a></li><li><a href="ko.bindingHandlers.validatableValue.html">validatableValue</a></li><li><a href="ko.bindingHandlers.widgetLocaleText.html">widgetLocaleText</a></li><li><a href="koValidation.alphaNumeric.html">alphaNumeric</a></li><li><a href="koValidation.alphaNumericNoSpaces.html">alphaNumericNoSpaces</a></li><li><a href="koValidation.alphaNumericNoSpacesWithSeperators.html">alphaNumericNoSpacesWithSeperators</a></li><li><a href="koValidation.alphaNumericWithSeperators.html">alphaNumericWithSeperators</a></li><li><a href="koValidation.bool.html">bool</a></li><li><a href="koValidation.creditcard.html">creditcard</a></li><li><a href="koValidation.cvv.html">cvv</a></li><li><a href="koValidation.endmonth.html">endmonth</a></li><li><a href="koValidation.endyear.html">endyear</a></li><li><a href="koValidation.importFileName.html">importFileName</a></li><li><a href="koValidation.laterDate.html">laterDate</a></li><li><a href="koValidation.match.html">match</a></li><li><a href="koValidation.mediaZipFileName.html">mediaZipFileName</a></li><li><a href="koValidation.number.html">number</a></li><li><a href="koValidation.observablePattern.html">observablePattern</a></li><li><a href="koValidation.password.html">password</a></li><li><a href="koValidation.price.html">price</a></li><li><a href="koValidation.propertyIdAlreadyInUse.html">propertyIdAlreadyInUse</a></li><li><a href="koValidation.propertyNameAlreadyInUse.html">propertyNameAlreadyInUse</a></li><li><a href="koValidation.restrictSlashCharacters.html">restrictSlashCharacters</a></li><li><a href="koValidation.startmonth.html">startmonth</a></li><li><a href="koValidation.startyear.html">startyear</a></li><li><a href="koValidation.uniqueTrimmed.html">uniqueTrimmed</a></li><li><a href="koValidation.uniqueTrimmedCaseInsensitive.html">uniqueTrimmedCaseInsensitive</a></li><li><a href="koValidation.url.html">url</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.addTemplate.html">addTemplate</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.ccDate.html">ccDate</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.ccDateTime.html">ccDateTime</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.ccNumber.html">ccNumber</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.disabled.html">disabled</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.element.html">element</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.embeddedAssistance.html">embeddedAssistance</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.inTabFlow.html">inTabFlow</a></li><li><a href="module-ccKoExtensions-ko.bindingHandlers.setContextVariable.html">setContextVariable</a></li><li><a href="NavStateViewModel.html">NavStateViewModel</a></li><li><a href="OrderHistoryViewModel.html">OrderHistoryViewModel</a></li><li><a href="OrderViewModel.html">OrderViewModel</a></li><li><a href="ParentOrganisation.html">ParentOrganisation</a></li><li><a href="ProductListingSearchViewModel.html">ProductListingSearchViewModel</a></li><li><a href="ProductListingViewModel.html">ProductListingViewModel</a></li><li><a href="ProductViewModel.html">ProductViewModel</a></li><li><a href="PubSub.topicNames.html">topicNames</a></li><li><a href="resetCVV.html">resetCVV</a></li><li><a href="resetPaymentDetails.html">resetPaymentDetails</a></li><li><a href="SearchRestClient.html">SearchRestClient</a></li><li><a href="UserViewModel.html">UserViewModel</a></li><li><a href="WidgetViewModel.html">WidgetViewModel</a></li><li><a href="WishlistContentViewModel.html">WishlistContentViewModel</a></li></ul><h3>Namespaces</h3><ul><li><a href="ko.bindingHandlers.html">bindingHandlers</a></li><li><a href="ko.extenders.html">extenders</a></li><li><a href="koValidation.html">koValidation</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CCEETagProcessor">CCEETagProcessor</a></li><li><a href="global.html#isValidDeterminewhetherornotthepaymentdetailsobjectisvalidbasedonthevalidityofitscomponentparts.Thiswillnotcauseerrormessagestobedisplayedforanyobservablevaluesthatareunchangedandhaveneverreceivedfocusontherelatedformfield(s).">isValid
Determine whether or not the payment details object is valid
based on the validity of its component parts. This will not
cause error messages to be displayed for any observable values
that are unchanged and have never received focus on the 
related form field(s).</a></li><li><a href="global.html#validatePaymentDetailsForceallrelevantmemberobservablestoperformtheirvalidationnow&displaytheerrors(ifany)">validatePaymentDetails
Force all relevant member observables to perform their
validation now & display the errors (if any)</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0</a> on Mon Oct 10 2016 10:49:02 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
